<div class="container-fluid">
    <app-navbar locationClass="form"></app-navbar>
    <div class="row form-header">
        <div class="col-1">
            <app-sidebar></app-sidebar>
        </div>
        <div class="col-6">
            <div>
                <h3>Register Sensor</h3>
            </div>
            <hr>
            <div>
                <ng-container *ngFor="let form of masterForm; let i = index; trackBy: trackByFn">
                    <form [formGroup]="masterForm[i]" *ngIf="i === activeStepIndex || masterForm.length === 1">
                        <div class="row">
                            <div class="col-12">
                                <div *ngFor="let field of formFields[i]; trackBy: trackByFn"
                                     [ngSwitch]="currentFormContent[i][field].type">
                                    <div>
                                        <label class="field-label text-bold" [for]="field">{{ field }}</label>
                                        <ng-container *ngSwitchCase="'textarea'">
                                            <textarea [id]="field"
                                                      [formControlName]="field"
                                                      [placeholder]="currentFormContent[i][field].placeholder"></textarea>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="'select'">
                                            <select [formControlName]="field" [id]="field">
                                                <option value="">Select your Country</option>
                                                <option *ngFor="let option of currentFormContent[i][field].options; trackBy: trackByFn"
                                                        [value]="option.name">{{ option.name }}</option>
                                            </select>
                                        </ng-container>
                                        <ng-container *ngSwitchDefault>
                                            <input [type]="currentFormContent[i][field].type"
                                                   [formControlName]="field"
                                                   [id]="field"
                                                   [placeholder]="currentFormContent[i][field].placeholder"/>
                                        </ng-container>
                                    </div>
                                    <p class="validation-error"
                                       *ngIf="(masterForm[i].get(field).dirty || masterForm[i].get(field).touched) &&
                                       masterForm[i].get(field).invalid && masterForm[i].get(field).errors">
                                        {{ getValidationMessage(i, field) }}
                                    </p>
                                </div>
                            </div>
                            <div class="col-12"
                                 *ngIf="activeStepIndex === stepItems.length - 1">
                                <ul>
                                    <li
                                        class="form-details-list"
                                        *ngFor="let field of masterFormFields; trackBy: trackByFn">
                                        <span class="text-bold">{{ field }}</span>
                                        <span>{{ formData[field] || 'N/A' }}</span>
                                    </li>
                                </ul>
                            </div>
                            <div class="col-12">
                                <button type="button" class="btn btn-primary btn-lg mr-3 my-2"
                                        [disabled]="!activeStepIndex"
                                        (click)="goToStep('prev')">Previous</button>
                                <button type="button" class="btn btn-primary btn-lg mr-3 my-2"
                                        *ngIf="activeStepIndex === stepItems.length - 1"
                                        (click)="onFormSubmit()">Submit</button>
                                <button type="button" class="btn btn-primary btn-lg my-2 float-right"
                                        [disabled]="activeStepIndex === stepItems.length - 1 || masterForm[i].invalid"
                                        (click)="goToStep('next')">Next</button>
                            </div>
                        </div>
                    </form>
                </ng-container>
                <div style="text-align:center;margin-top:40px;">
                    <span class="step"></span>
                    <span class="step"></span>
                    <span class="step"></span>
                    <span class="step"></span>
                </div>
            </div>
        </div>
        <div class="col-5" style="height: 88vh; max-height: 88vh">
            <app-map searchBarHeight="3vh"></app-map>
        </div>`
    </div>
</div>
